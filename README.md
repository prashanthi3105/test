CREATE OR REPLACE PROCEDURE migrate_data AS
BEGIN
    FOR rec IN (SELECT * FROM T_BQR_CUSTOMER_CALC_TEMP_CBAC)
    LOOP
        -- Search for matching data in T_ART_CBAC_AD_GROUPS_MIGRATION
        SELECT ART_SEQID
        INTO v_art_seqid
        FROM T_ART_CBAC_AD_GROUPS_MIGRATION
        WHERE _GROUP_NAME = rec.ACCESS_LEVEL_DESC
        OR ART_GROUP_NAME = rec.FINAL_ACCESS_LEVEL_DESC;
        
        -- Update T_BQR_CUSTOMER_CALC_TEMP_CBAC table
        UPDATE T_BQR_CUSTOMER_CALC_TEMP_CBAC
        SET ACCESS_GROUP_LOB_CODE = v_art_seqid,
            CUSTOMER_REQUEST_SEG = rec.CUSTOMER_REQUEST_SEG
        WHERE ACCESS_LEVEL_DESC = rec.ACCESS_LEVEL_DESC
        OR FINAL_ACCESS_LEVEL_DESC = rec.FINAL_ACCESS_LEVEL_DESC;
    END LOOP;
END migrate_data;
/

